[Ссылка](https://drive.google.com/drive/folders/12yqlo65q5d9y06ePtZeVWfJVtPJVTBOb?usp=sharing) на zip с эмбеддингами и скачанную итоговую модель CatBoost

[Ссылка](https://disk.yandex.ru/d/i-rTKANkGjKawQ) на исходные данные

## Подход к решению задачи

### 1. Исследовательский анализ данных (EDA)

На этапе EDA была проанализирована структура датасета и типы признаков. В
Принятые решения:
- пропуски в категориальных признаках заполнены отдельной категорией "Неизвестно";
- семантически одинаковые категории объединены для уменьшения шума в данных.
- логарифмирование численных признаков
- извлечение сезона и месяца (анализ показал что месяц эффективнее, к сожалению был потерян ноутбук (произошел вылет из ноутбука Kaggle без сохранения), в котором сравнивались оба подхода)
- Заменять выбросы медианными значениям по категории или делать клиппинг (также был утерян код с проверкой этой гипотезы, не дало роста)
---
### 2. Предобработка данных
#### Категориальные признаки
Категориальные признаки были закодированы вручную с помощью one hot и target encoding. Также была протестирована встроенная обработка категориальных признаков в модели CatBoost, однако ручное кодирование показало более лучшее качество.
#### Текстовые признаки
Для текстовых признаков были протестированы два подхода:
- TF-IDF представление текста;
- использование эмбеддингов SBERT.

Эмбеддинги не дали значимого прироста качества по сравнению с TF-IDF в Ridge, в CatBoost было принято решение передавать эмбеддинги, так как он лучше работать с плотными векторами, нежели чем с разреженными
#### Числовые признаки
Числовые признаки логарифмировались.
#### Изображения
Были получены эмбеддинги ResNet50, также проводился файнтюнинг последних слоев, но он не дал значимого результата (также к сожалению кода не осталось)

---
### 3. Выбор модели

В качестве базовой модели использовались линейные регрессии с L2 регуляризацией для получения baseline-результатов.

Основной моделью стал CatBoostRegressor, который был обучен с учётом числовых, категориальных и текстовых признаков. Среди протестированных вариантов наилучшее качество показал CatBoost с ручным кодированием категориальных признаков.

---
### 4. Оценка качества

Для оценки качества моделей использовалась метрика logMAE. Итоговая модель показала наилучшее значение метрики на тестовой выборке по сравнению с альтернативными подходами. Также просматривались MAE, RMSE, $R^2$, LogMAE 